- cmd: print
  delay: 0
  jitter: 0.05
  lines:
  - "U-Boot 2014.01 (Nov 04 2015 - 16:20:05) - stm24-2015-06-15"
  - ""
  - ""
  - "Board: B2120-revc-STxH410  [ARM]"
  - "I2C:   ready"
  - "DRAM:    2 GiB"
  - "MMC:   boot from SPI."
  - "stm-sdhci0: 0, stm-sdhci1: 1"
  - "SPI:  info: found ST N25Q256 (32MiB) device (page=256,erase=65536)"
  - "In:    serial"
  - "Out:   serial"
  - "Err:   serial"
  - "Net:   stmac-1"
  - "Hit any key to stop autoboot: 10  "

- cmd: print
  interrupt: True
  delay: 0
  jitter: 0.05
  lines:
  - "Hit any key to stop autoboot: 9  "
  - "Hit any key to stop autoboot: 8  "
  - "Hit any key to stop autoboot: 7  "
  - "Hit any key to stop autoboot: 6  "
  - "Hit any key to stop autoboot: 5  "
  - "Hit any key to stop autoboot: 4  "
  - "Hit any key to stop autoboot: 3  "
  - "Hit any key to stop autoboot: 2  "
  - "Hit any key to stop autoboot: 1  "

- cmd: wait
  delay: 0
  jitter: 0.05
  for: "boot"
  prompt: "B2120> "
  loop: True
  echo: True

- cmd: print
  delay: 0.001
  jitter: 0.005
  lines:
  - "(Re)start USB..."
  - "USB0:   Register 2000240 NbrPorts 2"
  - "Starting the controller"
  - "USB XHCI 1.00"
  - "scanning bus 0 for devices... 1 USB Device(s) found"
  - "       scanning usb for storage devices... 0 Storage Device(s) found"
  - "Using MAC Address 00:80:e1:12:7d:ba"
  - "STM-GMAC: REALTEK RTL8367RB found"
  - "STM-GMAC: Allocating coherent descriptors "
  - "Successfully allocated coherent descriptors "
  - "BOOTP broadcast 1"
  - "BOOTP broadcast 2"
  - "*** WARNING: using vendor optional boot file"
  - "*** WARNING: using vendor optional boot file"
  - "DHCP client bound to address 10.48.1.227"
  - "Using MAC Address 00:80:e1:12:7d:ba"
  - "STM-GMAC: REALTEK RTL8367RB found"
  - "STM-GMAC: Using already allocated descriptors."
  - "Using stmac-1 device"
  - "TFTP from server 10.201.20.162; our IP address is 10.48.1.227; sending through gateway 10.48.3.254"
  - "Filename 'tmpJD4EVt/uImage_stlinux'."
  - "Load address: 0x41000000"
  - "Loading: *\b#################################################################"
  - "\t #################################################################"
  - "\t #################################################################"
  - "\t #################################################################"
  - "\t #################################################################"
  - "\t ####"
  - "\t   2.9 MiB/s"
  - "done"
  - "Bytes transferred = 4822904 (499778 hex)"
  - "Using MAC Address 00:80:e1:12:7d:ba"
  - "STM-GMAC: REALTEK RTL8367RB found"
  - "STM-GMAC: Using already allocated descriptors."
  - "Using stmac-1 device"
  - "TFTP from server 10.201.20.162; our IP address is 10.48.1.227; sending through gateway 10.48.3.254"
  - "Filename 'tmpJD4EVt/stih410-b2120_stlinux.dtb'."
  - "Load address: 0x47000000"
  - "Loading: *\b#############"
  - "\t   1.9 MiB/s"
  - "done"
  - "Bytes transferred = 182911 (2ca7f hex)"
  - "## Booting kernel from Legacy Image at 41000000 ..."
  - "   Image Name:   Linux-3.10.92-b2120-h410+"
  - "   Image Type:   ARM Linux Kernel Image (uncompressed)"
  - "   Data Size:    4822840 Bytes =   4.6 MiB"
  - "   Load Address: 42008000"
  - "   Entry Point:  42008000"
  - "   Verifying Checksum ... OK"
  - "## Flattened Device Tree blob at 47000000"
  - "   Booting using the fdt blob at 0x47000000"
  - "   Loading Kernel Image ... OK"
  - "   Using Device Tree in place at 47000000, end 4702fa7e"
  - ""
  - "Starting kernel ..."
  - "   Using FDT blob at 0x47000000"
  - "Starting kernel ..."
  - ""
  - "OpenEmbedded nodistro.0 stmarm /dev/ttyAS0"
  - ""

- cmd: wait
  for: "root"
  prompt: "stmarm login: "
  loop: True
  fail: "Login incorrect"

- cmd: wait
  for: "export PS1=\"lava-test: # \""
  prompt: "stmarm:~# "
  loop: True

- cmd: wait
  for: "lava-test-runner" # TODO: should be a regexp and should grab a variable
  prompt: "lava-test: # "
  loop: true
  echo: True
